---
title: Install in an air-gapped environment
description: Learn how to install the Harness Self-Managed Enterprise Edition using Helm in an air-gapped environment. 
# sidebar_position: 60
---

This document explains how to use Helm to install the Harness Self-Managed Enterprise Edition in an air-gapped environment. It explains the process of obtaining and transferring Docker images to a private registry for you to access them securely. The steps include pulling Docker images, saving them as .tgz files, uploading to Google Cloud storage, downloading Helm charts, and pushing charts to your private repositories. This process ensures secure and seamless deployment of the Harness Self-Managed Platform in restricted, offline environments.

Air-gapped environments are characterized by a lack of direct access to the internet, which provides an added layer of security for sensitive data and systems. This isolation poses unique challenges to deploy and update software applications, as standard methods of accessing resources, such as Docker images, are not possbile.

The Harness Self-Managed Platform is designed to cater to various deployment scenarios, including an air-gapped environment. To facilitate this, the platform provides a secure and efficient method for obtaining and transferring Docker images to a private registry. This ensures that you can access, download, and push the required resources within your restricted network.

## Workstation requirements

- A minimum of 150GB of free disk space to download and extract the Harness airgap bundle

- ECR/GCR/private registry details to tag and push images

- Kubernetes cluster

- Latest version of Helm 

- Access to Helm charts or download locally

- Access to [the Harness airgap bundle on GCP](https://storage.googleapis.com/smp-airgap-bundles/harness-airgapped.tgz) 

- Kubernetes version 1.22+ (Harness recommends v1.23.x)

## Kubernetes cluster requirements

|**Modules**|**Pods**|**CPU**|**Memory (GB)**|**Storage (GB)**|
|---|---|---|---|---|
|HarnessPlatform|40|50.4|125.4|1090|
|Harness FirstGen|21|28|27|960|

## Installation workflow

The flowchart below shows the air-gapped environment installation workflow steps.

![](./static/air-gapped-environment-workflow.png)

## Download required files

To begin your installation, download the following files:

- Harness Docker images [harness-docker-images.txt](https://storage.googleapis.com/smp-airgap-bundles/harness-docker-images.txt)
- Harness air-gapped bundle [harness-airgapped.tgz](https://storage.googleapis.com/smp-airgap-bundles/harness-airgapped.tgz)
- Harness airgap images [harness-airgap-images.sh](https://storage.googleapis.com/smp-airgap-bundles/harness-airgap-images.sh)

## Save Docker images to your private registry

After you download the required files, you must save your Docker images to your private registry.

**To save your Docker images**

1. Sign in to your private registry.
    ```
    #Authenticate with Docker for Docker Registry
    docker login <registry-url>

    # Authenticate with Google Cloud Platform for GCR
    gcloud auth login

    # Authenticate with AWS for ECR
    aws ecr get-login-password --region <region> | docker login --username AWS --password-
    ```
    All Docker files required to deploy Harness are stored in a `harness-docker-images.txt` file in the Helm repo. The downloaded image bundle is `harness-airgapped.tgz`.
2. Add the `harness-airgapped.tgz` and `harness-docker-images.txt` to your air-gapped network. You can now push your images locally.
3. Run `harness-airgap-images.sh`.
    ```
    ./harness-airgap-images.sh --registry <REGISTRY.YOURDOMAIN.COM:PORT> --image-bundle harness-airgapped.gz --file harness-docker-images.txt
    ````

## Download and push Helm charts
After you save Docker images to your private registry, you must download the Helm charts and push them to your repository.

**To download and push Helm charts**

You can use Helm to pull the chart and push it to your private repository or download the chart directly.

- 
    ``` 
    helm repo add harness https://harness.github.io/helm-charts
    helm pull harness/harness 
    helm push harness docker://private-repo
    ```

**To download the Helm chart**
 
 - Download the chart from the [Harness repository](https://github.com/harness/helm-charts/releases).

## Install via Helm
Next, you are ready to install via Helm by updating your `override.yaml` file with your private registry information.

1. Update the `override.yaml` file with our private registry information.
    ```
    global:
    imageRegistry: "private-123.com"
    ```
2. Run the Helm install command.
    ```
    helm install my-release harness/harness-prod -n <namespace> -f override.yaml
    ```
